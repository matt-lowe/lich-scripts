=begin

	This script runs around foraging for herbs until you have a herbsack with 50 bites of each herb

	tillmen@lichproject.org

=end

unless defined?(Map.dijkstra) and defined?(dothis)
	echo 'Your version of Lich is too old for this script.'
	exit
end

unless Lich.herbsack
	echo 'No herbsack has been set.  Use ;settings change herbsack <container>'
	exit
end

unless Lich.lootsack
	echo 'No lootsack has been set.  Use ;settings change lootsack <container>'
	exit
end

herb_rooms =  {
	'acantha leaf'    => [ 6090, 10297, 10269, 10292, 10295, 10296, 6095, 6094, 10170, 10169, 10168, 10167, 284, 290, 291, 10271, 6526, 10282, 10286, 10283, 10284, 10285, 3263, 3262, 3261, 3260, 3253, 10195, 10196, 10198, 10197, 10189, 10183, 10200, 10201, 10184, 10202, 10209, 10236, 10234, 10235, 10233, 10218, 10219, 10220, 10221, 10222, 14035, 14042, 377, 14041, 256, 5831, 5023, 5026, 4612, 4990, 4991, 4992, 312, 4993, 311, 310, 300, 299, 298, 296, 3741, 288, 1298, 1299, 10877, 10876, 10875, 10874, 10866, 10869, 10864, 9244, 9243, 225, 224, 14047, 14048, 10854, 10852, 10856, 10857, 10842, 9624, 9625, 9622, 9627, 9628, 11022, 11021, 11020, 11018, 11006, 11023, 11024, 11025, 10463, 10461, 11028, 11029, 11030, 11032, 673, 10453, 10452, 10450, 10443, 10444, 10445, 10446, 10885, 10449, 10886, 10448, 10884, 10447, 10883, 10882, 10878, 10873, 6002, 6001, 6000, 5999, 6003, 6004, 6010, 5992, 5993, 5991, 5990, 1820, 5975, 10478, 5973, 5968, 5967, 5963, 10479, 5964, 5962, 5961, 5470, 5469, 5468, 5467, 5956, 5466, 5465, 6083, 6074, 6078, 6079, 6075, 6077, 6076, 6024, 6023, 10489, 6022, 1697, 6026, 6012, 10486, 10485, 6042, 6059, 6060, 6061, 6062, 6063, 5099, 6044, 6045, 6046, 6048, 6058, 6055, 6054, 6047, 6049, 6057, 6032, 6040, 6039, 6033, 6034, 6038, 6035, 6037, 6036, 9890, 9887, 9886, 9885, 9884, 56, 12087, 12086, 11961, 11960, 11959, 11958, 11962, 11963, 11965, 7210, 7209, 7208, 547, 9140, 9143, 1714, 1713, 8580, 8579, 8578, 8577, 8576, 7281, 8575, 7282, 7157, 7277, 7276, 7275, 7274, 7199, 7198, 7188, 7261, 7255, 3564, 3831, 3565, 3566, 3567, 3568, 3569, 1280, 7251, 7203, 7202, 7201, 7197, 7185, 3571, 3570, 3574, 4135, 4134, 7016, 7948, 7944, 7945, 7946, 7947, 7939, 7942, 7943, 7941, 8306, 8296, 8311, 8302, 8324, 8295, 8298, 8300, 8288, 8290, 7929, 7927, 7930, 7928, 3759, 7966, 8280, 8278, 8277, 8276, 7996, 8320, 222, 410, 6909, 6888, 6772, 6773, 6774, 6775, 6779, 6798, 8317, 8316, 8315, 8314, 8312, 8318, 7924, 7923, 7922, 439, 13037, 13036, 13035, 13034, 13033, 221, 411, 447, 448, 450, 13038, 452, 4300, 463, 6744, 6756, 6755, 6754, 6753, 6762, 6763, 6764, 6767, 6768, 6765, 6766, 6769, 6282, 6275, 6266, 6263, 6262, 427, 426, 424, 213, 6960, 12058, 12059, 12060, 416, 6319, 6317, 6318, 415, 417, 418, 7998, 9700, 9701, 10139, 10256, 10253, 10254, 10230, 10229, 10261, 10257, 10258, 10259, 10255, 3891, 3892, 6091, 6092, 6093, 10291, 10290, 10289, 6100, 6098, 10293, 10294, 6510, 6511, 6512, 10165, 10164, 10163, 10162, 11314, 229, 228, 285, 295, 292, 10272, 10273, 10274, 10275, 10278, 10276, 10277, 10281, 10279, 10280, 1368, 1369, 1412, 1411, 12384, 10194, 10193, 10192, 10190, 10191, 12379, 10199, 227, 276, 10203, 10205, 10207, 10214, 10212, 10210, 10208, 10215, 10213, 10211, 10217, 10225, 10224, 10227, 10223, 10216, 10232, 10231, 10226, 10228, 14046, 14045, 14044, 13983, 13980, 254, 316, 313, 258, 3890, 314, 315, 309, 308, 305, 304, 303, 301, 9256, 223, 10870, 10861, 10853, 14049, 13997, 13991, 294, 13990, 13989, 13988, 13998, 293, 10840, 10849, 10848, 10847, 10838, 10844, 10845, 9629, 1188, 9621, 1235, 1234, 1233, 1232, 10394, 11007, 10460, 10462, 10459, 10457, 10458, 10456, 11033, 10454, 10455, 10442, 10441, 10451, 6005, 6006, 6008, 6009, 5995, 5996, 5997, 5998, 5994, 86, 9830, 9831, 5988, 5989, 5987, 5986, 5985, 1831, 1832, 1833, 1834, 1835, 5060, 5965, 5476, 5966, 5969, 5474, 5058, 5972, 5473, 5971, 5970, 5472, 5958, 5959, 5960, 5957, 5053, 5052, 6084, 6085, 6086, 6089, 6088, 6087, 6073, 6082, 6081, 6080, 6041, 10488, 6020, 6013, 4268, 1701, 4267, 6069, 6068, 6072, 6070, 6071, 6067, 6066, 6065, 6064, 6043, 10493, 6052, 6053, 6050, 6051, 6030, 6029, 6028, 6027, 6031, 49, 50, 51, 52, 53, 54, 55, 9888, 9889, 9891, 12076, 12079, 12078, 12077, 12082, 12083, 12084, 11964, 11957, 11956, 11955, 11966, 11967, 7248, 7250, 7249, 7207, 7287, 7286, 7285, 7284, 7283, 7278, 7279, 7280, 7161, 7162, 7156, 1287, 1286, 1285, 1284, 7196, 1282, 1281, 7191, 7193, 7194, 7190, 7189, 7186, 7187, 3562, 3563, 7155, 475, 1277, 8431, 1278, 7266, 1279, 7267, 7270, 7252, 3572, 3573, 7184, 8496, 7170, 8495, 7171, 7169, 7165, 10791, 4139, 4138, 8319, 8310, 8308, 8304, 7937, 7940, 7938, 7933, 7934, 7935, 7932, 7931, 8292, 8293, 8286, 8284, 8322, 8323, 8321, 8283, 8282, 8281, 3607, 3606, 3605, 3603, 3602, 3601, 4259, 6778, 6780, 6783, 6781, 6782, 6785, 6784, 464, 442, 443, 444, 445, 438, 432, 430, 433, 434, 454, 455, 6749, 6750, 6751, 456, 6752, 6745, 6746, 6747, 6748, 6776, 6777, 3769, 6723, 6725, 6722, 6284, 6267, 6265, 6269, 6261, 12051, 12056, 12057, 214, 215, 216, 217, 218, 419, 220, 6315, 6314, 12067, 12073, 12074, 12075, 420, 435, 436, 437, 441, 421, 422, 429, 431, 4816, 564, 10260, 10238, 10239, 562, 2010, 2008, 2007, 2006, 2003, 2001, 1999, 1998, 1997, 1995, 12533, 1967, 12385, 12566, 12568, 2005, 2004, 2021, 2009, 12569, 12570, 2000, 2002, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 12586, 12585, 2056, 2057, 2058, 2059, 2060, 2066, 2067, 2071, 2072, 2074, 2073, 12652, 2076, 2075, 2083, 2082, 2081, 2080, 2079, 2078, 2077, 12638, 2084, 2053, 2085, 2086, 2087, 2088, 2089, 2091, 2093, 2100, 2102 ],
	'ambrominas leaf' => [ 10297, 10269, 10292, 10295, 10296, 6095, 6530, 6531, 10172, 10171, 10177, 10178, 10179, 10180, 10181, 10182, 10195, 10196, 10198, 10197, 10189, 10183, 10200, 10201, 10184, 10209, 10236, 10234, 10235, 10233, 10866, 10869, 10864, 9626, 10463, 11027, 10461, 11028, 11029, 11030, 10453, 10452, 10450, 10443, 10444, 10445, 10446, 10449, 10448, 10447, 6002, 6001, 6000, 5999, 6003, 6004, 5676, 5980, 5981, 5992, 5993, 5979, 5982, 5991, 5990, 5975, 10478, 5973, 5968, 5967, 5963, 10479, 5964, 5962, 5961, 1414, 1413, 5956, 5466, 5465, 6083, 6074, 6078, 6079, 6075, 6077, 6076, 6060, 6061, 6062, 6063, 6045, 6046, 6048, 6058, 6055, 6054, 6047, 6049, 6057, 42, 6032, 6040, 6039, 6033, 6038, 6035, 6037, 6036, 6380, 6382, 6383, 1634, 1293, 8542, 8580, 8579, 8578, 8577, 8576, 8575, 539, 540, 4134, 7944, 7945, 7946, 7947, 7939, 7942, 7943, 7941, 8296, 8311, 8302, 8324, 8295, 8298, 8300, 8288, 7929, 7927, 7930, 7996, 8320, 410, 3770, 6773, 6774, 6775, 6788, 6790, 6794, 6791, 6796, 6795, 8316, 8315, 8312, 8318, 447, 449, 452, 453, 6766, 6769, 423, 6960, 12058, 4201, 10261, 10257, 3892, 6091, 6092, 6093, 10291, 10290, 10289, 6100, 6098, 10293, 10294, 11314, 10176, 10175, 10174, 10173, 10194, 10193, 10192, 10190, 10191, 10185, 10186, 10187, 10188, 10199, 10214, 10212, 10210, 1372, 10208, 1373, 10215, 10213, 1374, 10211, 13983, 9926, 1219, 10871, 10870, 10460, 10462, 10459, 10457, 10458, 10456, 10454, 10455, 10442, 10441, 10451, 6005, 5254, 6006, 6007, 6008, 6009, 5995, 5996, 5997, 5998, 11864, 5994, 11860, 11863, 11859, 11862, 11858, 5978, 5495, 5983, 5988, 5989, 5977, 5984, 5987, 5986, 5985, 5976, 5965, 5966, 5969, 5972, 5066, 5971, 5970, 5958, 5071, 5959, 5960, 5957, 6084, 6085, 6086, 6089, 6088, 6087, 6073, 6082, 6081, 6080, 1652, 6069, 6068, 6072, 6070, 6071, 6067, 6066, 6065, 6064, 10493, 6052, 6053, 6050, 6051, 6030, 6029, 6028, 6027, 6031, 49, 50, 51, 52, 53, 12077, 12082, 2115, 5063, 11967, 5062, 5061, 8319, 8310, 8308, 8304, 7937, 7940, 7938, 7933, 7934, 7935, 7932, 7931, 8293, 8286, 8284, 8323, 8283, 6792, 6780, 6783, 6781, 6782, 6784, 6787, 6786, 6789, 442, 443, 444, 445, 4341, 8038, 8039, 8040, 12056, 12057, 12073, 12074, 12075, 436, 437, 441, 4200, 10238, 10239, 12586, 12585, 2056, 2057, 2058, 2059, 2060 ],
	'cactacae spine'  => [ 10265, 318, 10125, 188, 376, 4086, 288, 8689, 10867, 5358, 5359, 5331, 10375, 10063, 10484, 10482, 6011, 5074, 5075, 5077, 5078, 5080, 5081, 3495, 5119, 5118, 5117, 10483, 8508, 8509, 8279, 6258, 12052, 13343, 13346, 13347, 13344, 13345, 10244, 10247, 10243, 10249, 10250, 10251, 10252, 10262, 10263, 10264, 13325, 380, 379, 675, 10861, 10863, 10841, 10373, 10374, 5327, 10457, 5072, 5073, 5049, 5048, 5124, 5123, 5122, 5121, 5120, 8461, 446, 12053, 10237, 10246, 10245, 10240, 10241, 10242, 10248, 10267, 10266, 12567 ],
	'aloeas stem'     => [ 1358, 3263, 3262, 3261, 3260, 3253, 5295, 11006, 11023, 11024, 11025, 11032, 1826, 1825, 1824, 1823, 1822, 1821, 7210, 7209, 7208, 8536, 7281, 7282, 7275, 7200, 7199, 7198, 7188, 7261, 7263, 7203, 7204, 7205, 7202, 7201, 7185, 7936, 7928, 3759, 3758, 3608, 4347, 440, 4300, 6282, 6275, 6266, 6263, 6262, 6961, 12046, 12065, 12064, 1356, 1357, 10838, 11007, 11033, 10092, 10093, 7248, 7250, 7249, 7207, 7296, 7297, 7287, 7286, 7285, 7284, 7283, 7278, 7279, 7280, 1283, 7196, 7191, 7193, 7194, 7190, 7189, 7186, 7187, 7266, 7270, 7184, 7170, 7171, 7169, 7165, 4138, 7288, 7289, 7290, 7291, 7292, 7293, 7294, 7295, 6265, 6269, 12070, 12071, 12072, 10126, 2061, 2062 ],
	'haphip root'     => [ 10265, 9722, 6090, 574, 570, 569, 568, 6094, 566, 10170, 10169, 10168, 10167, 318, 10125, 3727, 10271, 10282, 10286, 10283, 10284, 10285, 10204, 10206, 10218, 10219, 10220, 10221, 10222, 5831, 5023, 5026, 5027, 4612, 4990, 4991, 4992, 4993, 5002, 5000, 5013, 5014, 5012, 5015, 5005, 5004, 5006, 288, 5011, 8692, 8693, 8689, 8690, 8691, 9931, 10375, 5455, 5451, 3495, 6034, 56, 12086, 11960, 11963, 1633, 1635, 1636, 7157, 7255, 3564, 3565, 3566, 3569, 1280, 8280, 8277, 222, 6258, 6772, 6779, 7924, 7923, 7922, 13037, 13036, 13035, 13034, 13033, 13038, 6762, 6763, 6764, 6767, 6768, 6765, 416, 6319, 6317, 6318, 9700, 9701, 9729, 9728, 10256, 9725, 10253, 9726, 10254, 10230, 9712, 10229, 10258, 10259, 10255, 9719, 9718, 9717, 9727, 591, 590, 10244, 10247, 10243, 580, 10249, 579, 10250, 10251, 10252, 10262, 10263, 10264, 587, 589, 573, 585, 583, 577, 10165, 10164, 10163, 10162, 10272, 10273, 10274, 10275, 10278, 10276, 10277, 10281, 10279, 10280, 10217, 10225, 10224, 10227, 10223, 10216, 10232, 10231, 10226, 10228, 4994, 4995, 4996, 4998, 4999, 5001, 9929, 5003, 5007, 5008, 5010, 9961, 9960, 9959, 10373, 10374, 86, 9830, 4268, 4267, 55, 11966, 11967, 7161, 7162, 7156, 1287, 1286, 1285, 1284, 1282, 1281, 3563, 7155, 475, 1277, 8431, 1278, 1279, 7267, 3572, 8282, 8281, 3605, 3600, 6778, 4214, 454, 6776, 6777, 216, 6315, 6314, 435, 4816, 564, 9704, 10126, 9713, 9714, 9716, 9715, 9721, 9720, 10260, 9711, 10237, 9710, 9709, 9708, 10246, 10245, 10240, 10241, 10242, 10248, 625, 561, 560, 559, 10267, 9724, 10266, 9723, 2010, 2008, 2007, 2006, 2003, 2001, 1999, 1998, 12379, 12566, 12567, 12568, 2005, 2004, 2021, 2009, 12569, 12570, 2000, 2002, 2022, 2023, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2082, 2081, 2079, 2078, 2077, 2090 ],
	'pothinir grass'  => [ 1269, 1095, 9953, 16272, 16273, 16274, 16275, 9895, 5152, 5153, 5154, 5156, 5157, 5159, 5160, 5161, 8580, 8579, 8578, 8577, 8576, 8575, 7258, 7257, 7259, 7256, 3624, 3564, 3826, 3831, 3565, 3566, 3569, 3571, 3570, 3574, 4196, 6291, 6292, 6290, 6296, 6289, 6288, 8187, 4202, 5784, 5789, 5788, 3890, 1221, 1220, 1101, 9976, 16279, 16256, 16280, 16270, 16271, 5287, 1222, 1223, 5148, 5149, 2180, 3562, 3825, 3563, 7269, 7264, 7271, 3572, 3573, 3600, 6287, 6286, 6277, 6278, 5812, 5810, 5792, 5791, 5790, 5783, 5782, 12578, 12577, 12576, 12575, 2017, 2016, 2015, 2014, 2012, 2011, 2010, 2008, 2007, 2006, 2003, 2001, 1999, 1998, 14798, 12568, 2005, 2004, 2021, 2009, 12569, 12570, 2000, 2002, 2022, 2023, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2013, 2018, 2019, 2020, 12579, 12580, 12581, 2066, 2067, 2072, 2074, 2073, 2076, 2075, 2083, 2082, 2081, 2080, 2079, 2078, 2077, 12638, 2084, 2085, 2086, 2087, 2088, 2089, 2090, 2091, 2093, 2102 ],
	'basal moss'      => [ 6090, 6094, 10170, 10169, 10168, 10167, 10271, 10282, 10286, 10283, 10284, 10285, 10218, 10219, 10220, 10221, 10222, 5831, 5026, 5027, 4612, 4990, 4991, 4992, 4993, 5015, 5006, 5322, 1142, 10856, 10857, 10886, 5261, 5262, 5455, 4269, 5116, 5115, 5099, 6034, 56, 12086, 11961, 11960, 11959, 11958, 11962, 11963, 11965, 6823, 222, 4215, 13037, 13036, 13035, 13034, 13033, 13038, 463, 6319, 6317, 6318, 10256, 10253, 10254, 10230, 10229, 10258, 10259, 10255, 10165, 10164, 10163, 10162, 10272, 10273, 10274, 10275, 10278, 10276, 10277, 10281, 10279, 10280, 12379, 10217, 10225, 10224, 10227, 10223, 10216, 10232, 10231, 10226, 10228, 4994, 4995, 4996, 4998, 4999, 151, 5007, 5008, 1143, 11026, 5249, 5252, 5253, 5674, 86, 9830, 9831, 4268, 4267, 4270, 4271, 5109, 5100, 54, 55, 12083, 11964, 11957, 11956, 11955, 11954, 11966, 7161, 7162, 1282, 7155, 475, 1277, 8431, 1278, 1279, 3603, 3602, 3601, 4214, 454, 456, 12054, 12067, 435, 564, 10260 ],
	'ephlox moss'     => [ 5293, 1136, 1135, 1123, 5290, 5292, 5638, 1822, 1821, 1820, 1713, 7281, 7282, 7277, 4135, 448, 427, 426, 424, 213, 5639, 5288, 5289, 10090, 10091, 10092, 10093, 1831, 1832, 1833, 1834, 1835, 7287, 7286, 7285, 7284, 7283, 7278, 7279, 7280, 8476, 8496, 8495, 4139, 4138, 3603, 3602, 3601, 432, 430, 433, 434, 6261, 214, 215, 217, 218, 421, 422, 429, 431 ],
	'calamia fruit'   => [ 10265, 6090, 6094, 10170, 10169, 10168, 10167, 318, 233, 289, 290, 232, 291, 10125, 10271, 188, 10282, 10286, 10283, 10284, 10285, 10204, 10206, 10202, 9337, 10218, 10219, 10220, 10221, 10222, 14035, 376, 256, 5831, 5026, 5027, 4086, 4085, 312, 311, 310, 300, 299, 298, 296, 3741, 288, 361, 1142, 8692, 8693, 8689, 225, 224, 286, 14047, 14048, 10854, 10852, 10856, 14033, 14034, 1157, 10375, 11022, 11021, 11020, 11019, 11042, 11043, 89, 5261, 6010, 5262, 5480, 3495, 6024, 6023, 10489, 6022, 4292, 4269, 4293, 4294, 4295, 6026, 6012, 10486, 10485, 6042, 6059, 6044, 6034, 12087, 12086, 11961, 11960, 11959, 11958, 11962, 11963, 11965, 547, 548, 550, 1636, 7157, 7199, 7198, 7261, 7255, 3564, 3565, 3567, 3569, 1280, 7203, 7202, 3571, 3570, 3574, 7948, 8306, 8290, 7928, 3759, 8280, 8279, 8278, 8277, 222, 6258, 6772, 6779, 6798, 8317, 8314, 7924, 7923, 7922, 439, 13037, 13036, 13035, 13034, 13033, 221, 411, 13038, 463, 6744, 6756, 6755, 6754, 6753, 6762, 6763, 6764, 6767, 6768, 6765, 12052, 12065, 12064, 416, 6319, 6317, 6318, 415, 417, 418, 8187, 9700, 9701, 10256, 10253, 10254, 10230, 10229, 10258, 10259, 10255, 10244, 10247, 10243, 10249, 10250, 10251, 10252, 10262, 10263, 10264, 10165, 10164, 10163, 10162, 11314, 1356, 1357, 231, 228, 292, 10272, 10273, 10274, 10275, 10278, 10276, 10277, 10281, 10279, 10280, 1369, 1410, 276, 10203, 10205, 10207, 9336, 10217, 10225, 10224, 10227, 10223, 10216, 10232, 10231, 10226, 10228, 14046, 14045, 14044, 14043, 234, 254, 316, 313, 380, 379, 4999, 3890, 5001, 314, 315, 309, 308, 305, 304, 303, 301, 1221, 223, 10861, 10863, 10853, 14049, 14050, 13997, 13991, 294, 13990, 13998, 13999, 14001, 293, 10840, 1143, 10373, 10374, 11035, 11036, 11037, 11038, 11039, 11040, 11041, 5249, 5252, 5253, 88, 87, 6041, 10488, 6020, 6013, 4296, 4268, 4267, 4270, 4271, 4297, 4272, 4273, 4274, 4298, 6043, 54, 55, 62, 12079, 12078, 12083, 12084, 11964, 11966, 11951, 11950, 1653, 7161, 7162, 7156, 1287, 1286, 1285, 1284, 1282, 1281, 3563, 7155, 475, 1277, 8431, 1278, 7266, 1279, 7267, 7270, 3573, 8292, 8322, 8321, 8282, 8281, 3607, 3606, 3605, 3600, 6778, 6785, 438, 4197, 454, 455, 6749, 6750, 6751, 456, 457, 6752, 6745, 6746, 6747, 6748, 6776, 6777, 3769, 6284, 6267, 12053, 216, 419, 220, 6315, 6314, 12067, 420, 435, 4816, 9704, 9705, 10126, 10260, 10237, 10246, 10245, 10240, 10241, 10242, 10248, 562, 625, 561, 560, 10267, 10266, 2010, 2008, 2007, 2006, 2003, 2001, 1999, 1998, 1997, 1995, 1967, 12379, 12384, 12385, 12566, 12567, 12568, 2005, 2004, 2021, 2009, 12569, 12570, 2000, 2002, 2022, 2023, 2024, 2025, 2026, 2027, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2066, 2067, 2071, 2072, 2074, 2073, 2076, 2075, 2083, 2082, 2081, 2080, 2079, 2078, 2077, 12638, 2084, 2053, 2085, 2086, 2087, 2088, 2089, 2090, 2091, 2093, 2100, 2102 ],
	'sovyn clove'     => [ 10265, 10297, 10269, 10292, 10295, 10296, 6095, 318, 284, 289, 290, 291, 10125, 188, 10195, 10196, 10198, 10197, 10189, 10183, 10200, 10201, 10184, 259, 260, 273, 10209, 10236, 10234, 10235, 10233, 319, 14042, 14041, 14039, 238, 312, 311, 310, 300, 299, 298, 296, 3741, 288, 8692, 8693, 8689, 8690, 8691, 10866, 10869, 10864, 225, 224, 14048, 10854, 10852, 14034, 5017, 5019, 10375, 10463, 11027, 10461, 11028, 11029, 11030, 11031, 10453, 10452, 10450, 10443, 10444, 10445, 10446, 10449, 10448, 10447, 10878, 6002, 6001, 6000, 5999, 6003, 6004, 6010, 5992, 5993, 5991, 5990, 5975, 10478, 5973, 5968, 5967, 5963, 10479, 5964, 5962, 5961, 5469, 5468, 5467, 5956, 5466, 5083, 6083, 3495, 6074, 6078, 6079, 6075, 6077, 6076, 6024, 6023, 10489, 6022, 6026, 6012, 10486, 10485, 6042, 6059, 6060, 6061, 6062, 6063, 6044, 6045, 6046, 6048, 6058, 6055, 6054, 6047, 6049, 6057, 6032, 6040, 6039, 6033, 6038, 6035, 6037, 6036, 59, 11968, 470, 471, 472, 4134, 7948, 7944, 7945, 7946, 7947, 7939, 7942, 7943, 7941, 8306, 8296, 8311, 8302, 8324, 8295, 8298, 8300, 8288, 8290, 7929, 7927, 7930, 8278, 7996, 8320, 410, 6258, 4252, 4253, 6773, 6774, 6775, 8151, 6798, 8317, 8316, 8315, 8314, 8312, 8318, 439, 221, 411, 447, 452, 6766, 6769, 6960, 12061, 12058, 12062, 415, 417, 418, 10261, 10257, 10244, 10247, 10243, 10249, 10250, 10251, 10252, 3892, 10262, 10263, 10264, 6091, 6092, 6093, 10291, 10290, 10289, 6100, 6098, 10293, 10294, 231, 230, 229, 228, 285, 295, 292, 1412, 10194, 10193, 10192, 10190, 10191, 10199, 276, 10214, 10212, 10210, 10208, 1373, 10215, 10213, 1374, 10211, 275, 324, 239, 14043, 13983, 254, 316, 313, 314, 315, 309, 308, 305, 304, 303, 301, 223, 10870, 10861, 10863, 10853, 14049, 14050, 13997, 13991, 294, 13990, 13989, 13988, 13998, 293, 10840, 9978, 10373, 10374, 5323, 5324, 10460, 10462, 10459, 10457, 10458, 10456, 10454, 10455, 10442, 10441, 10451, 6005, 6006, 6008, 6009, 5995, 5996, 5997, 5998, 5994, 5988, 5989, 5987, 5986, 5985, 5060, 5965, 5059, 5966, 5969, 5058, 5972, 5066, 5971, 5970, 5958, 5071, 5959, 5960, 5957, 5053, 5052, 6084, 6085, 6086, 6089, 6088, 6087, 6073, 6082, 6081, 6080, 6041, 10488, 6020, 6013, 6069, 6068, 6072, 6070, 6071, 6067, 6066, 6065, 6064, 6043, 10493, 6052, 6053, 6050, 6051, 6030, 6029, 6028, 6027, 6031, 49, 50, 51, 52, 12077, 12082, 5063, 11967, 5062, 5061, 8435, 8319, 8310, 8308, 8304, 7937, 7940, 7938, 7933, 7934, 7935, 7932, 7931, 8292, 8293, 8286, 8284, 8322, 8323, 8321, 8283, 3607, 3606, 6780, 6783, 6781, 6782, 6784, 442, 443, 444, 445, 438, 412, 413, 4199, 4198, 4197, 3769, 6284, 6267, 12055, 12056, 12057, 419, 220, 12073, 12074, 12075, 420, 436, 437, 441, 10237, 10238, 10239, 10246, 10245, 10240, 10241, 10242, 10248, 10267, 10266, 1997, 1995, 1967, 12384, 12385, 12567, 12586, 12585, 2056, 2057, 2058, 2059, 2060, 2053 ],
	'wolifrew lichen' => [ 3263, 3262, 3261, 3260, 3253, 8554, 1319, 1320, 1820, 7231, 7228, 7230, 7227, 7226, 7225, 7229, 9079, 9080, 9081, 9082, 9085, 9088, 9092, 9091, 9089, 9090, 7224, 7214, 7246, 7247, 7212, 7213, 7211, 7210, 7209, 7208, 1713, 7277, 7276, 7275, 7188, 7260, 7201, 7197, 7185, 4135, 8073, 448, 450, 4318, 4321, 6282, 6275, 6274, 6272, 6273, 6266, 6263, 6262, 427, 426, 424, 213, 5822, 5821, 5820, 5819, 5818, 5807, 5806, 5797, 5805, 5804, 5803, 5801, 5800, 5799, 4855, 1370, 1371, 8570, 1104, 1103, 11084, 11085, 10090, 1831, 1832, 1833, 1834, 1835, 1819, 1818, 55, 7233, 7234, 7232, 7774, 9076, 9077, 9083, 9075, 7221, 7220, 7219, 7218, 7217, 7216, 7222, 7215, 7223, 9087, 9084, 9086, 9071, 9072, 7248, 7250, 7249, 7207, 7196, 7191, 7193, 7194, 7190, 7189, 7186, 7187, 7184, 8496, 7170, 8495, 7171, 7169, 7165, 4139, 4138, 7959, 7956, 7957, 7958, 7955, 7953, 7951, 7954, 7952, 3603, 3602, 3601, 7964, 7963, 7962, 7960, 7961, 432, 430, 433, 434, 1258, 1257, 1256, 4319, 6723, 6725, 6722, 6265, 6269, 6283, 6261, 6276, 6279, 6281, 6280, 214, 215, 217, 218, 421, 422, 429, 431, 5817, 5816, 5815, 5814, 5813, 5809, 5808, 5798, 5796, 5795, 5794, 5793 ],
	'woth flower'     => [ 16275, 7157, 7255, 3564, 3565, 3566, 3569, 1280, 3571, 3570, 3574, 7924, 7156, 1287, 1286, 1285, 1284, 1281, 3563, 7267, 3572, 3573, 2010, 2008, 2007, 2006, 2003, 2001, 1999, 1998, 12568, 2005, 2004, 2021, 2009, 12569, 12570, 2000, 2002, 2022, 2023, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2082, 2081, 2079, 2078, 2077  ],
	'torban leaf'     => [ 6090, 6094, 10170, 10169, 10168, 10167, 10271, 10282, 10286, 10283, 10284, 10285, 1407, 10218, 10219, 10220, 10221, 10222, 5831, 5023, 5026, 5027, 4612, 4990, 4991, 4992, 4993, 5002, 5000, 5013, 5014, 5012, 5015, 5005, 5004, 5006, 5011, 10877, 10876, 10875, 10874, 10856, 10857, 9931, 11022, 11021, 11020, 11019, 11018, 11014, 10873, 5455, 4292, 4269, 4293, 4294, 4295, 6034, 9887, 9886, 9885, 9884, 11965, 546, 547, 548, 549, 550, 1633, 8280, 8277, 222, 6772, 6779, 460, 459, 7923, 7922, 13037, 13036, 13035, 13034, 13033, 13038, 463, 6762, 6763, 6764, 6767, 6768, 6765, 416, 6319, 6317, 6318, 9700, 9701, 10256, 10253, 10254, 10230, 10229, 10258, 10259, 10255, 10165, 10164, 10163, 10162, 11314, 10272, 10273, 10274, 10275, 10278, 10276, 10277, 10281, 10279, 10280, 12379, 10217, 10225, 10224, 10227, 10223, 10216, 10232, 10231, 10226, 10228, 4994, 4995, 4996, 4998, 4999, 5001, 9929, 5003, 5007, 5008, 5010, 9961, 9960, 9959, 11012, 11013, 11026, 5249, 86, 9830, 4296, 4268, 4267, 4270, 4271, 4297, 4273, 4274, 4298, 9888, 9889, 9891, 11955, 11966, 7161, 7162, 1282, 7155, 475, 1277, 8431, 1278, 8282, 8281, 3605, 4223, 4222, 6778, 4264, 454, 456, 457, 6776, 6777, 12054, 216, 6315, 6314, 435, 4816, 9704, 10260, 625, 12566 ]
}

#
# list of herbs that will be foraged for
#
herb_list = [ 'haphip root', 'pothinir grass', 'ephlox moss', 'calamia fruit', 'sovyn clove', 'wolifrew lichen', 'woth flower', 'torban leaf', 'acantha leaf', 'ambrominas leaf', 'cactacae spine', 'basal moss', 'aloeas stem' ]

#
# where to go when done foraging
#
# done_goto = 'Upper Dragonsclaw, Boulder'
done_goto = Room.current.id.to_s

#
# returns the room closest to you
#
find_nearest = proc { |target_list|
	start_room = Room.current
	least_time = nil
	least_target = nil
	previous, shortest_distances = Map.dijkstra(start_room.id)
	for target in target_list
		if start_room.id == target
			least_target = target
			least_time = 0
			break
		end
		est_time = shortest_distances[target]
		if !est_time.nil? and (least_time.nil? or least_time > est_time)
			least_target = target
			least_time = est_time
		end
	end
	if least_time < 30
		least_target
	else
		nil
	end
}

#
# this function handles all the foraging and bundling in a room
#    returns true if the bundle is full and we should move on to the next herb
#    returns false if the room ran dry
#
forage = proc { |herb|
	bundle_full = false
	begin
		#
		# forage faster
		#
		if (Spells.majorelemental >= 6) and not checkspell(506) and checkmana(6)
			fput 'incant 506'
		elsif (Spells.minorelemental >= 2) and not checkspell(402) and checkmana(2)
			fput 'incant 402'
		end
		#
		# paranoia
		#
		if checkleft
			dothis 'stow left', /^You put|^You are not holding anything in your left hand\.$/
		end
		if checkright
			dothis 'stow right', /^You put|^You are not holding anything in your right hand\.$/
		end		
		#
		# forage
		#
		forage_result = dothistimeout 'forage for ' + herb, 5, /^You forage|^You make so much noise that only the dead would not notice you thrashing about in your unsuccessful search\.$|^You stumble about in a fruitless attempt at foraging\.$|you are unable to find anything useful|^As you carefully forage around you (can find no hint|see no evidence) of what you are looking for\.|^You begin to forage around when your hand comes into contact with something that stabs you in the finger\.$|^As you forage around you suddenly feel a sharp pain in your right hand!|^You begin to forage around when suddenly you feel a burning sensation in your hand\.$|^You fumble about so badly in your search that you can only hope no one was watching you\.$/
		sleep 0.5
		waitrt?
		if forage_result =~ /^You forage briefly and manage to find/
			#
			# we found something, try to bundle it
			#
			get_result = dothis 'get my ' + herb + ' from my ' + Lich.herbsack, /^You remove|^Get what/
			if get_result =~ /^You remove/
				#
				# bundle; if theres too much to bundle, eat and try again
				#
				loop {
					bundle_result = dothistimeout 'bundle', 3, /^Carefully, you combine|^If you add anything more to this bundle|^You do not have anything to bundle!$/
					if bundle_result =~ /^Carefully, you combine/
						dothis 'put my ' + herb + ' in my ' + Lich.herbsack, /^You put|^I could not find what you were referring to\.$/
						break
					elsif bundle_result =~ /^If you add anything more to this bundle/
						dothis 'eat my ' + herb, /^You take a bite/
						#
						# stop foraging for this herb
						#
						bundle_full = true
					else
						break
					end
				}
			else
				#
				# there's nothing to bundle with, just put it away and continue
				#
				dothis 'put my ' + herb + ' in my ' + Lich.herbsack, /^You put|^I could not find what you were referring to\.$/
			end
		elsif forage_result =~ /^As you forage around you suddenly feel a sharp pain in your right hand!/
			if (limb_repair = Spell[1102]) and limb_repair.known? and limb_repair.affordable?
				limb_repair.cast
			else
				start_script 'useherbs'
				wait_while { running? 'useherbs' }
			end
		end
		#
		# try again unless the room is dry or the bundle is full
		#
	end until (bundle_full == true) or forage_result.nil? or (forage_result =~ /you are unable to find anything useful|^As you carefully forage around you (can find no hint|see no evidence) of what you are looking for\./)
	bundle_full
}


#
# try to open the herb pouch, remember to close it or not
#
open_result = dothis 'open my ' + Lich.herbsack, /^You open|^That is already open\.$/
if open_result =~ /^You open/
	close_herbsack = true
else
	close_herbsack = false
end

empty_hands

used_rooms = Array.new

for herb in herb_list
	
	loop {
		#
		# goto a room with this herb, or move on to the next herb
		#
		this_room = Map.current
		next_room = find_nearest.call(herb_rooms[herb] - used_rooms)
		if next_room.nil?
			break
		else
			used_rooms.push(next_room)
			start_script 'go2', [ next_room.to_s, '_disable_confirm_' ]
			wait_while { running? 'go2' }
			if this_room == Map.current
				break
			else
				unless checkpcs or checknpcs
					#
					# forage until the room is dry or the bundle is full
					#
					bundle_full = forage.call(herb)
					#
					# move on to the next herb if the bundle is full
					#
					break if bundle_full
				end
			end
		end
	}

end

fill_hands

#
# close the herbsack if we opened it
#
if close_herbsack
	dothis 'close my ' + Lich.herbsack, /^You close|^That is already closed\.$/
end

#
# go somewhere nice
#
if done_goto
	start_script 'go2', [ done_goto, '_disable_confirm_' ]
	wait_while { running? 'go2' }
end

#start_script('autorest') unless running?('autorest')
